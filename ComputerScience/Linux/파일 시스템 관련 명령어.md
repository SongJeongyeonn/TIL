# 권한 및 그룹 설정
- 리눅스 시스템은 모든 파일과 디렉터리에는 접근권한과 소유권이 부여된다.
- 명령어 'ls -l'은 파일 속성을 나타낸다. (ex. -rw-rw-r-- 1 yong yong 53 2025-02-28 18:50 TST)
- 속성 필드 중 첫 번째 필드는 파일이나 디렉터리의 허가권, 세 번째와 네 번째 필드는 파일이나 디렉터리의 소유권을 나타낸다.
- 파일의 허가권이나 소유권을 설정하는 명령어는 chmod, chown, chgrp, umask 등이 있다.


## (1) 소유권과 관련 명령어
- 소유권은 임의의 파일 또는 디렉터리에 대해 사용자와 그룹들의 소유 권한을 나타낸 것이다.
- 그룹은 사용자들의 시스템 운영 특성에 따라 묶어 놓은 것으로, 같은 그룹에 속한 사용자들은 파일 또는 디렉터리에 대해 동일한 소유권과 작업 권한을 갖는다.

1. 명령어 chown
   - 명령어 chown는 파일과 디렉터리의 사용자 소유권과 그룹 소유권을 변경한다.
   - 형식: #chown[옵션]소유자[그룹명]파일명
2. 명령어 chgrp
   - 명령어 chgrp는 change group을 줄인 명령어로 파일이나 디렉터리의 그룹 소유권을 변경한다.
   - 명령어 chown은 소유자와 소유 그룹을 모두 변경할 수 있지만 chgrp는 그룹 소유권만을 변경한다.
   - 형식: #chgrp [옵션]그룹명 파일명

## (2) 허가권(permission)과 관련 명령어
- 명령어 'ls -l'으로 파일 유형과 허가권을 알 수 있다.
- 파일 허가권의 첫 번째 자리는 파일 유형을 기호로 정의한다.
- 파일은 **일반 파일, 디렉터리 파일, 특수 파일**로 나뉜다.
- 명령어 ls -l/dev를 실행하면 파일 유형이 'b'나 'c'나 'l'인 파일들을 확인할 수 있다.(b는 저장, c는 입출력, l은 연결)
- 파일 허가권의 두 번째 자리에서 열 번째 자리는 파일 접근 권한을 정의한다.
- 리눅스는 사용자 별로 파일 권한을 부여한다.
- 파일 사용자는 순서대로 **파일 소유자(owner), 그룹 소속자(group) 그리고 기타 사용자(others or public)**로 구분한다.
```
파일 권한을 부여하는는 요소는 다음과 같다.
그리고 8진수로 변환할 수 있다.
r: read(읽기), 4
w: write(수정), 2
x: excute(실행), 1
-: 권한 없음
```
즉 위에서 예시로 보여준 명령을 해석하면 다음과 같다.
```
-rw-rw-r-- 1 yong yong 53 2025-02-28 18:50 TST
```
**TST는 일반 파일(-)** 이며, **파일의 소유자는 yong**은 **읽고 수정(rw-)** 만 할 수 있고, 파일 소속자도 **읽고 수정(rw-)** 만 할 수 있다. 그리고 그 외의 기타 사용자는 **읽기(r--)** 만 할 수 있다.

그리고 파일 권한은 8진수로도 표시할 수 있다.
```
764 TST => rwxrw-r-- TST
```
1. **명령어 chmod**
   - 파일이나 디렉터리의 접근 허가권을 변경하는 명령어이다.
   - 형식: #chomd[옵션]파일명
   - **숫자모드**를 이용한 권한 변경과 **기호모드**를 이용한 권한 변경이 있다.
```
- 숫자모드는 위에서 언급한 8진수를 이용한다.
rw-r--r--
6 4 4
chmod 644 TST.txt
```
#### 기호모드에 대해 알아보자!

u는 소유자, g는 그룹, o는 기타사용자, a는 모든 사용자이다.

그리고 +와 -로 권한을 부여하거나 제거할 수 있다.

r은 읽기 권한, w을 쓰기 권한, x는 실행 권한이다.

```
- 기타모드
chmod o+w TST.txt
이 명령은 기타 사용자의 권한에 쓰기 권한을 추가하겠다는 것이다.
```
2. **명령어 umask**
   - 명령어 umask는 새로 생성되는 파일이나 디렉터리의 기본 허가권 값을 지정한다.
   - 파일의 기본 권한은 666, 디렉터리의 기본 권한은 777이다. 명령어 umask는 디폴드 권한 값을 변경한다.
   - 형식: umask[옵션][값]
   - 파일이나 디렉터리 생성 시 디폴트 권한 값에서 설정한 umask값을 뺀 기본 허가권으로 설정한다.
   - umask -s는 umask 값을 문자로 나타낸다.
```
umask 값이 0002라고 하자 
그리고 mkdir AAA를 하면
777권한을 가진 디렉터리가 생기는게 아니라
0777 - 0002 = 0775
즉 d rwx rwx r-x의 권한을 가진 디렉터리가 생기는 것이다.
그래서 기본허가권은 umask의 값에 따라서 조정할 수 있다.
```
## (3) 특수 권한
1. **SetUID와 SetGID**
   - 프로세스가 실행되는 동안 해당 프로세스의 root권한을 임시로 가져오는 기능이다.
   - 프로세스가 사용자보다 **높은 수준의 접근을 요구할 때** 파일 접근 제한 때문에 원활한 기능을 제공할 수 없기 때문에 이러한 문제점을 해결하기 위한 방법이다.
   - SetUID(4)의 경우 사용자가 사용할 때만 소유자 권한으로 파일을 실행시키고, SetGID(2)의 경우 사용자가 사용할 때만 그룹 권한으로 파일을 실행한다.
2. **Sticky bit**
   - 일반적으로 공용 디렉터리를 사용할 때 sticky bit를 설정하여 사용한다.
   - sticky bi(1)가 설정되어 있는 디렉터리 안의 내용은 해당 파일의 소유자나 root만이 변경 가능하여 공용 디렉터리라도 권한의 제약을 두어 다른 사용자들의 파일 보고하기 위한 목적으로 만든 것이다.
   - 사용자 권한을 지정하기 어려운 프로그램들이 일시적으로 특정 디렉터리에 파일을 생성하고 삭제하도록 이용된다.
   - 특정 운용 프로그램이 다른 응용 프로그램에서 생성된 파일을 삭제하지 못하는 권한 설정을 한다.
   - 설정된 디렉터리에는 누구든 접근 가능하고 파일을 생성할 수 있다.
   - 생성된 sticky bit파일을 삭제 시에는 소유자(파일 생성자)와 관리자만 치울 수 있다. 다른 사용자는 자신의 소유가 아닌 파일을 삭제할 수 없다.

## (4) 디스크 쿼터
- 파일 시스템마다 사용자나 그룹이 생성할 수 있는 파일의 용량 및 개수를 제안하는것이다. 보통 블록 단위의 용량 제한과 inode의 개수를 제한한다.
- 사용자나 그룹이 가질 수 있는 inode의 수, 사용자나 그룹에게 할당된 디스크 블록 수를 제한한다.
- 쿼터는 사용자별, 파일 시스템별로 동작된다.
- 그룹 단위로도 용량을 제한할 수 있으며 웹호스팅 서비스를 하는 경우에 유용하다.
1. 디스크 쿼터 지정단계
   - 단계 1: 파일 /etc/fstab에 디스크 쿼터 관련 설정
   - 단계 2: 재마운팅(remounting) 실행 후 확인
   - 단계 3: 마운트 된 쿼터를 끄고 생성된 쿼터 파일 삭제
   - 단계 4: 쿼터 데이터베이스 생성
   - 단계 5: 사용자별 쿼터 지정
   - 단계 6: 쿼터 현재 상황 점검
2. 디스크 쿼터 관련 명령어
   - 명령어 quotaoff: 쿼터 서비스를 비활성화 한다.
   - 명령어 quotocheck: 파일 시스템의 디스크 사용 상태를 검색한다.
   - 명령어 edquoto: 편집기를 이용하여 사용자나 그룹에 디스크 사용량을 할당하는 명령이다.
   - 명령어 setquota: 편집기가 기반이 아닌 명령행에서 직접 사용자나 그룹에 디스크 사용량을 할당하는 명령어이다.
---
# 파일 시스템의 관리
## (1) 파일 시스템의 개요와 종류
1. 개요
   - 운영체제가 파일을 시스템의 디스크상에 구성하는 방식이다.
   - 컴퓨터에서 파일이나 자료를 쉽게 발견 및 접근할 수 있도록 보관 또는 조직하는 체제이다.
   - 하드 디스크나 CD-ROM와 같은 물리적 저장소를 관리한다.
   - 파일 서버상의 자료로의 접근을 제공하는 방식과 가상의 형태로서 접근 수단만이 존재하는 방식도 파일 시스템의 범위에 포한된다.
   - 리눅스 파일 시스템의 구조는 다음과 같이 나타낼 수 있다.

2. 종류
- 리눅스 전용 디스크 기반 파일 시스템

|파일 시스템|설명|
|:--:|:--:|
|ext(ext1)|리눅스 초기에 사용되던 파일 시스템이며 호환성이 없음/ ext2의 원형/ 2GByte의 데이터와 파일명을 255자까지 지정 가능/ 파일 접근에 대한 타임 스탬프, 아이노드 수정 지원 불가|
|ext2|ext 파일 시스템의 다음 버전/ 고용량 디스크 사용을 염두하고 설계된 파일 시스템/ 쉽게 호환되며 업그레이드도 쉽게 설계되어 있음|
|ext3|ext2의 확장판/ 리눅스 대표적인 저널링을 지원하도록 홝장된 파일 시스템/ ACL(Access Control List)을 통한 접근 제어 지원|
|ext4|ext2 및 ext3와 호환성 있는 확장 버전/ 파일에 디스크 할당 시 물리적으로 연속적인 블록을 할당/ 64비트 기억 공간 제한을 없앰/ 16 TeroByte의 파일을 지원|

- 저널링 파일 시스템

|파일 시스템|설명|
|:--:|:--:|
|JFS|Journaling File System의 약자/ IBM사의 독자적인 저널링 파일 시스템/ GPL로 공개하여 현재 리눅스용으로 개발|
|xfs|eXetended File System/ 고 성능 저널링 시스템/ 64비트 주소를 지원하며 확장성이 있는 자료 구조와 알고리즘 사용/ 파일 수에 관계없이 예상치 못한 상황으로부터 신속한 복구와 재시작 가능/ 데이터 읽기,쓰기 트랜잭션으로 성능 저하를 최소화/ 64비트 파일 시스템으로 큰 용량의 파일도 다룰 수 있음/ 높은 확장성과 처리량을 가짐|
|ReiserFS|독일의 한스 라이저가 개발한 파일 시스템/ 리눅스용 저널링 파일 시스템 중에서 가장 안정적이라는 평가를 받음/ 모든 파일 객체들을 B트리에 저장, 간결한 색인화 된 디렉터리지원|

- 기타 지원 가능한 파일 시스템(1)

|파일 시스템|설명|
|:--:|:--:|
|FAT|Windows NT가 지원하는 파일 시스템 중 가장 간단한 시스템/ FAT로 포맷된 디스크는 클러스터 단위로 할당/ 클러스터 크기는 볼륨 크기에 따라 결정/ 읽기 전용, 숨김, 시스템 및 보관 파일 특성만 지원/ 삼바(samba)파일 시스템을 마운트 지정|
|VFAT (Virtual FAT)|FAT 파일 시스템이 확장된 것으로 FAT와 호환/ FAT보다 제한이 적음/ 파일 이름도 최대 255자까지 만들 수 있음/ 공백이나 여러 개의 구두점도 포함/ 대소문자는 지정한 대로 보존되기는 하나 구별하지는 않음|
|FAT32|SMB를 확장한 파일 시스템/ Windows 95, 98 및 ME과 같은 버전과 다중 부팅을 구성/ 32GB보다 큰 파티션을 만들 수 없고 파티션 4GB를 초과하는 파일을 저장할 수 없음|

- 기타 지원 가능한 파일 시스템(1)

|파일 시스템|설명|
|:--:|:--:|
|NTFS|윈도우에서 사용하는 파일 시스템/ 안정성이 뛰어나고 대용량 파일도 저장/ 안정성, 자세한 사용자 제한, 보안성 등이 FAT32보다 뛰어남/ 파일 크기 및 볼륨은 이론상으로 최대 16EB나 실질적으로는 2TB로 한계가 있음
|ISO 9660|CD-ROM의 표준 파일 시스템/ 16988년에 제정된 표준|
|UDF|Universal Disk Format의 약자로 최신 파일 시스템 형식/ OSTA에 의해 개발/ 광학 매체용 파일 시스템 표준/ ISO 9660 파일 시스템을 대체하기 위한 것으로 대부분 DVD에서 사용/ DVD 멀티미디어 디스크들은 MPEG 오디오 및 비디오 스트림을 담기위해 사용|
|HPFS|OS/2 운영체제를 위해 만들어진 파일 시스템/ 1988년 발표, 마이크로소프트와 IBM이 공동 개발|

## (2) 관련 명령어
1. **명령어 mount와 umount**
   - 마운트는 특정 디바이스를 특정 디렉터리처럼 사용하기 위해 장치와 디렉터리를 연결한다.
   - 리눅스는 PnP 기능을 지원하지만 지원하는 하드웨어가 많지 않으므로 시스템 부팅 후에 수동으로 마운트해서 사용을하고 사용이 끝난 후에는 언마운트를 시킨다.
   - 파일 /etc/mtab은 현재 마운트된 블록 시스템 정보를 표시한다ㅣ.
   - 마운트 설정 명령어 형식: mount[옵션][디바이스명][디렉터리명]
   - 마운트 헤제 명령어 형식: umount[옵션][디바이스명][디렉터리명]
2. **명령어 eject**
   - 이동식 보조기억장치(DVD or CD-ROM) 등과 같은 미디어를 해제하고 장치를 제거하는 명령어이다.
   - 형식: eject[옵션][디바이스명]
3. **명령어 fdisk**
   - 새로운 파티션의 생성, 기존 파티션의 삭제, 파티션의 타입 결정 등의 작업을 수행할 수 있다.
   - fdisk는 명령어 프롬포트 중심의 매우 간단한 인터페이스를 가지고 있다.
   - 형식: fdisk[옵션][장치명]
   - fdisk를 실행하기 위해서는 어떠한 디스크의 파티션을 나눌 것인지 알려주어야 한다.
   - 하나의 컴퓨터에 여러 개의 하드 디스크가 설치될 수 있으므로 어떤 하드 디스크의 파티션을 변경할 것인지 알려주어야 한다.
4. **명령어 mkfs**
   - 리눅스 파일 시스템을 생성한다.
   - fdisk로 하드 디스크를 파티션으로 나눈 후 해당 파티션에 맞는 파일 시스템을 생성한다.
   - 형식: mkfs[옵션]장치이름
5. **명령어 mke2fs**
   - ext2, ext3, ext4 타입의 리눅스 파일 시스템을 생성(포맷)하는 명령어이다.
   - fdisk 명령어로 파티션 작업을 한 후에 mke2fs 혹은 mke2fs 명령어로 파일 시스템을 생성한다.
   - 형식: mke2fs[옵션][장치명]
6. **명령어 fsck**
   - 파일 시스템의 무결성을 점검하고 대화식으로 복구하는 명령어이다ㅣ.
   - 디렉터리 /lost+found은 fsck에서 사용하는 디렉터리이다.
   - 형식: fsck[옵션]장치명
7. **명령어 e2fsck**
   - ext2, ext3, ext4타입의 리눅스 파일 시스템을 생성(포맷)하는 명령어이다.
   - 형식: e2fsck[옵션][디바이스명]
8. **명령어 du**
    - Disk Usog의 약자로 디렉터리별로 디스크 사용량을 확인할 수 있다.
    - 형식: du[옵션][파일 및 디렉터리명]
9.  **명령어 df**
    - 시스템에 마운트된 하드 디스크의 남은 용량을 확인할 때 사용하는 명령어이다.
    - 기본적으로 1,024Byte 블록 단위로 출력하며, 옵션을 통해 다른 단위로 출력이 가능하다.
    - 형식: df[옵션][파일명]